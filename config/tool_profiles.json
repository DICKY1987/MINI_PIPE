{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Tool Profiles Configuration",
  "description": "Defines external tool integration profiles for MINI_PIPE",
  "version": "1.0.0",
  
  "profiles": {
    "aider": {
      "tool_id": "aider",
      "contract_version": "AIDER_CONTRACT_V1",
      "description": "AI-powered code editing with Aider",
      "command_template": [
        "aider",
        "--no-auto-commits",
        "--yes",
        "--model", "{model_name}",
        "--message-file", "{prompt_file}"
      ],
      "default_env": {
        "AIDER_NO_AUTO_COMMITS": "1"
      },
      "optional_env": {
        "AIDER_MODEL": "{model_name}"
      },
      "default_timeout_seconds": 1800,
      "exit_codes": {
        "0": "Success",
        "1": "Tool error - check stderr",
        "-1": "Timeout",
        "-2": "Binary not found",
        "-3": "Execution error"
      },
      "requirements": {
        "binary": "aider",
        "min_version": "0.30.0"
      }
    },
    
    "pytest": {
      "tool_id": "pytest",
      "contract_version": "TOOL_CONTRACT_V1",
      "description": "Python test runner",
      "command_template": [
        "pytest",
        "-v",
        "--tb=short",
        "{test_paths}"
      ],
      "default_env": {},
      "default_timeout_seconds": 600,
      "exit_codes": {
        "0": "All tests passed",
        "1": "Tests failed",
        "2": "Test execution interrupted",
        "3": "Internal error",
        "4": "Command line usage error",
        "5": "No tests collected"
      },
      "requirements": {
        "binary": "pytest",
        "min_version": "7.0.0"
      }
    },
    
    "pyrefact": {
      "tool_id": "pyrefact",
      "contract_version": "TOOL_CONTRACT_V1",
      "description": "Automated Python refactoring",
      "command_template": [
        "pyrefact",
        "{file_paths}"
      ],
      "default_env": {},
      "default_timeout_seconds": 300,
      "exit_codes": {
        "0": "Success",
        "1": "Refactoring error"
      },
      "requirements": {
        "binary": "pyrefact"
      }
    },
    
    "snake-shift": {
      "tool_id": "snake-shift",
      "contract_version": "TOOL_CONTRACT_V1",
      "description": "Structural Python transforms (camelCase to snake_case)",
      "command_template": [
        "snake-shift",
        "{file_paths}"
      ],
      "default_env": {},
      "default_timeout_seconds": 300,
      "exit_codes": {
        "0": "Success",
        "1": "Transform error"
      },
      "requirements": {
        "binary": "snake-shift"
      }
    },
    
    "ruff": {
      "tool_id": "ruff",
      "contract_version": "TOOL_CONTRACT_V1",
      "description": "Python linter and formatter",
      "command_template": [
        "ruff",
        "check",
        "{file_paths}"
      ],
      "default_env": {},
      "default_timeout_seconds": 120,
      "exit_codes": {
        "0": "No issues found",
        "1": "Lint errors found"
      },
      "requirements": {
        "binary": "ruff"
      }
    },
    
    "git": {
      "tool_id": "git",
      "contract_version": "TOOL_CONTRACT_V1",
      "description": "Git version control operations",
      "command_template": [
        "git",
        "{git_subcommand}"
      ],
      "default_env": {},
      "default_timeout_seconds": 60,
      "exit_codes": {
        "0": "Success",
        "1": "Generic error",
        "128": "Command line error"
      },
      "requirements": {
        "binary": "git",
        "min_version": "2.30.0"
      }
    }
  },
  
  "routing_rules": {
    "operation_kind_to_tool": {
      "EXEC-AIDER-EDIT": "aider",
      "EXEC-PYTEST": "pytest",
      "EXEC-PYREFACT": "pyrefact",
      "EXEC-SNAKE-SHIFT": "snake-shift",
      "EXEC-RUFF-CHECK": "ruff",
      "EXEC-GIT-STATUS": "git",
      "EXEC-GIT-COMMIT": "git",
      "EXEC-GIT-WORKTREE": "git"
    }
  },
  
  "validation": {
    "require_contract_version": true,
    "enforce_timeout": true,
    "require_binary_check": true
  }
}
